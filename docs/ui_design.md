# UI 設計

このドキュメントでは、重複画像処理ツールの Web UI の設計について説明します。

## 1. ページ構成

### 1.1. 初期ページ

- **URL**: `/`
- **目的**: ツールの内部状態を確認し、内部状態に合わせたページにリダイレクトする。
- **画面要素**:
  - ヘッダー: プロジェクト名と簡単な説明。

### 1.2. 対象ディレクトリ設定

- **URL**: `/setup`
- **目的**: ユーザーに処理対象のディレクトリを選択してもらい、重複画像の検出を開始する。
- **画面要素**:
  - ヘッダー: プロジェクト名と簡単な説明。
  - ディレクトリ選択フォーム:
    - テキストボックス: 処理対象のディレクトリパスを入力。
    - ボタン: 「検出開始」ボタン。
  - アルゴリズム選択: ハッシュアルゴリズム (例: phash, ahash) を選択する。
  - 類似度設定: 重複画像と判断するための距離を指定する。
  - フッター: バージョン情報とリンク。
  - ページリンク: ごみ箱ページへのリンク。

### 1.3. 検出中ページ

- **URL**: `/searching`
- **目的**: 検出作業の進捗具合を示す。
- **画面要素**:
  - ヘッダー: プロジェクト名と簡単な説明。
  - 進捗バー: 検出が終わるまでのあいだ、進捗状況をプログレスバーで表示する。
  - フッター: バージョン情報とリンク。
  - ページリンク: 対象ディレクトリ設定ページやごみ箱ページへのリンク。
- **アクション**:
  - ときどきバックエンドに進捗を確認し、プログレスバーに状況を反映する。
  - 対象ディレクトリ設定ページへのリンクを踏まれたら、検出作業を中断して移動する。

### 1.4. 検出結果ページ

- **URL**: `/results`
- **目的**: 検出された重複画像グループを表示し、ユーザーに操作してもらう。
- **画面要素**:
  - ヘッダー: プロジェクト名と簡単な説明。
  - **メイン表示**:
    - 画像グループを一定数 (例: 20 件) ごとに表示する。
    - 「次へ」「前へ」ボタンを設置するか、あるいは遅延ローディングを実装する。
  - **画像グループ**:
    - サムネイル画像: グループ内の各画像のプレビュー。
    - ファイル情報: 各画像のパス、サイズ、時刻 (ctime, mtime, 撮影日時)。
    - 削除ボタン: 各画像の削除ボタン。
  - フッター: バージョン情報とリンク。
  - ページリンク: 対象ディレクトリ設定ページやごみ箱ページへのリンク。
- **アクション**:
  - **サムネイル画像のクリック**: リアル画像を表示する。
  - **サムネイル画像のドラッグドロップ**: 同一グループ内でサムネイル画像 A をドラッグして別のサムネイル画像 B の上にドロップした場合、以下いずれかのアクションを選択してもらって実行する。
    - **画像上書き**: 画像 B をごみ箱ページに移し、画像 B の位置には画像 A のハードリンクを置く。
    - **日時上書き**: 画像 B のコピーをごみ箱に対比させ、画像 B 自体の ctime, mtime, EXIF の撮影画像を、画像 A に揃える。
    - **キャンセル**: ドラッグドロップ前の状態に戻す。
  - **削除ボタン**: その画像をごみ箱に移動させる。
  - 対象ディレクトリ設定ページへのリンクを踏むと、検出結果は破棄して移動する。
  - ごみ箱ページへのリンクを踏むと、検出結果は壊さないよう内部に持ったまま、ごみ箱ページに移動する。

### 1.5. ごみ箱ページ

- **URL**: `/trash`
- **目的**: うっかり消してしまった画像の救出。
- **画面要素**:
  - ヘッダー: プロジェクト名と簡単な説明。
  - 全削除ボタン:
  - 検索:
  - 検索クリア
  - ごみ箱内の各画像:
    - サムネイル画像。
    - ごみ箱に移される前のファイル情報。
    - アクション: 削除されたのか、あるいは日時上書きされたのか、を示す。
    - 復旧ボタン
    - 削除ボタン
  - フッター: バージョン情報とリンク。
  - ページリンク: 対象ディレクトリ設定ページや検索結果ページへのリンク
- **アクション**:
  - **全削除ボタン**: ごみ箱を空にする。
  - **検索**: 削除されたファイルのファイル名, 上書きに使用したファイルのファイル名などで、ごみ箱内の画像を絞り込む。
  - **検索クリア**: 検索パラメーターをクリアし、絞り込みをやめる。
  - **サムネイル画像**: リアル画像を表示する。
  - **復旧ボタン**: 当該画像を元の場所に戻し、重複画像グループに戻す。
  - **削除ボタン**: 削除されたファイルを完全に消す。ディスクから削除し、復旧も不可能にする。
  - 対象ディレクトリ設定ページへのリンクを踏むと、検出結果は破棄して移動する。
  - 検索結果ページへのリンクを踏むと、検出結果ページに移動する。

## 2. ワイヤーフレーム

### 2.1. 初期ページ

```text
+-------------------------------------------+
| ヘッダー: プロジェクト名と簡単な説明       |
+-------------------------------------------+
| 内部状態を確認中...                       |
|                                           |
| [対象ディレクトリ設定ページに移動]         |
| [検出中ページに移動]                      |
| [検出結果ページに移動]                    |
+-------------------------------------------+
```

### 2.2. 対象ディレクトリ設定ページ

```text
+-------------------------------------------+
| ヘッダー: プロジェクト名と簡単な説明       |
+-------------------------------------------+
| 処理対象のディレクトリを選択してください。 |
| [ /path/to/images                     ]   |
|                                           |
| ハッシュアルゴリズム: [ phash ▼ ]         |
| 類似度設定: [ 90% ]                       |
|                                           |
| [ 検出開始 ]                               |
|                                           |
| [ごみ箱ページへのリンク]                  |
+-------------------------------------------+
| フッター: バージョン情報とリンク           |
+-------------------------------------------+
```

### 2.3. 検出中ページ

```text
+-------------------------------------------+
| ヘッダー: プロジェクト名と簡単な説明       |
+-------------------------------------------+
| 処理中...                                 |
| [##########--------------------] 50%      |
|                                           |
| [対象ディレクトリ設定ページに移動]         |
| [ごみ箱ページへのリンク]                  |
+-------------------------------------------+
| フッター: バージョン情報とリンク           |
+-------------------------------------------+
```

### 2.4. 検出結果ページ

```text
+-------------------------------------------+
| ヘッダー: プロジェクト名と簡単な説明       |
+-------------------------------------------+
|                                           |
| サムネイル1  ファイル情報1  [削除] [移動]  |
| サムネイル2  ファイル情報2  [削除] [移動]  |
| サムネイル3  ファイル情報3  [削除] [移動]  |
+............................................+
| サムネイル1  ファイル情報1  [削除] [移動]  |
| サムネイル2  ファイル情報2  [削除] [移動]  |
| サムネイル3  ファイル情報3  [削除] [移動]  |
+............................................+
| サムネイル1  ファイル情報1  [削除] [移動]  |
| サムネイル2  ファイル情報2  [削除] [移動]  |
| サムネイル3  ファイル情報3  [削除] [移動]  |
|                                           |
| ページネーション: [前へ] [次へ]           |
+-------------------------------------------+
| フッター: バージョン情報とリンク           |
+-------------------------------------------+
```

### 2.5. ごみ箱ページ

```text
+-------------------------------------------+
| ヘッダー: プロジェクト名と簡単な説明       |
+-------------------------------------------+
| [全削除] [検索: ____________] [検索クリア]|
|                                           |
| サムネイル1  ファイル情報1  [復旧] [削除]  |
| サムネイル2  ファイル情報2  [復旧] [削除]  |
| サムネイル3  ファイル情報3  [復旧] [削除]  |
|                                           |
| [対象ディレクトリ設定ページへのリンク]     |
| [検出結果ページへのリンク]                |
+-------------------------------------------+
| フッター: バージョン情報とリンク           |
+-------------------------------------------+
```

## 3. 注意事項

- UI はレスポンシブデザインを採用し、PC とモバイルの両方で利用可能にします。
- 必要に応じて、CSS フレームワーク（例: Bootstrap）を使用してデザインを簡略化します。
