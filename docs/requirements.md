# 重複画像処理システム 要件定義書

## 概要

NASに保存された画像ファイルから重複する画像を検出し、適切に処理を行うシステムの要件を定義します。このシステムでは、WebブラウザをUIとして使用し、バックエンドはUbuntu 22.04で動作することを前提とします。

---

## 要件

### 1. 重複の定義

- 類似画像を含む重複画像をグルーピングしたものを対象とするものとします。
- 完全一致の画像だけでなく、解像度の違いやトリミングによる見た目の類似性も考慮してグルーピングします。
- ただしトリミング画像の検出は、オプションです。負荷が大きいので、必要と指定された場合のみ、検出を行ないます。
- 類似度を判断するために閾値を設定し、調整可能とします。

---

### 2. グルーピング処理の範囲

- 特定のフォルダ (複数可) を指定して処理を実施するものとします。
- 最大容量は2TBを想定しますが、開発およびテスト段階では数GB程度のデータを使用します。
- 類似画像ごとのグループを作成し、グループごとに次章のアクションができるようにします。

---

### 3. グルーピング処理後のアクション

類似度に応じて以下の選択肢を提供します。

- **削除**: 重複により不要と判断された画像を削除します。
- **ハードリンク作成**: 画像は削除し、同一画像と判断した画像ファイルへのハードリンクで置き換えます。
- **撮影日付のみコピー**: 同一画像あるいは元画像と判断した画像ファイルから、ctime、mtime をコピーします。EXIF情報がある場合は撮影日付もコピーします。
- データの安全性を確保するため、削除した画像はごみ箱に保管します。
- ごみ箱に保管した画像は、ユーザーの確認を経て破棄します。

---

### 4. ツールと技術要件

- **UI**:
  
  - Webブラウザを介して操作できるようにします。
  - ユーザーフレンドリーなインターフェースを提供します。

- **バックエンド**:
  
  - Ubuntu 22.04で動作させます。
  - スクリプトを使用して事前に重複画像を検出してグルーピングします。

---

### 5. 確認作業

- 処理前に確認画面を表示する機能を必須とします。
- 類似画像のリストを出力し、手動で最終確認を行う仕組みを提供します。

---

## 次のステップ

1. スクリプトを設計および開発します。
2. サーバー環境をセットアップし、必要なツールをインストールします。
3. Webブラウザ向けのUIを設計し、プロトタイプを作成します。
4. 小規模データでテストを行い、精度や速度を調整します。
5. 確認画面を実装し、操作性を検証します。
